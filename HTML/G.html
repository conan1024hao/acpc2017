<%@ page pageEncoding="UTF-8"%>

<script type="text/x-mathjax-config">
  MathJax.Hub.Config({ tex2jax: { inlineMath: [["$","$"], ["\\(","\\)"]], processEscapes: true }});
</script>

<script language="JavaScript" type="text/javascript" src="http://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS_HTML">
</script>

<h1>Problem G: Ensoku</h1>

<h2>Problem</h2>
<p>
  明日はいよいよマイヅ小学校の遠足の日である。マイヅ小学校に通うがっちょくんは、楽しみのあまり明日のお菓子を買い忘れていたことに気づいた。<br>
  がっちょくんは遠足を最大限楽しむため、お菓子にもこだわりたい。<br>
<p>
<p>
  がっちょくんはお母さんから$X$円のお小遣いをもらってお菓子を買いに行く。ただし小学校のルールで遠足に持っていくお菓子の合計金額は$Y$円までと決まっていて、$Y$円を上回るとお菓子は全て先生に取り上げられてしまう。

<p>
  がっちょくんの住む学区には$N$個の町と$N$個の駄菓子屋がある。各町と各駄菓子屋には1から$N$の番号が割り振られており、町$i$には駄菓子屋$i$があり、がっちょくんは町1に住んでいる。<br>
  各駄菓子屋ではいくつかのお菓子が売っていて、各お菓子には1つあたりの値段、1つあたりのがっちょくんが得られる満足度、在庫数がある。<br>
  また、2つの町の間を移動するには公共交通機関を利用するため、町$i$からある町$j$へ直接移動するには$d_{ij}$円だけお金がかかる。ただし、同じ町内の移動にお金はかからない。<br>
  今、がっちょくんは町1にいる。がっちょくんが$X$円以内で$Y$円までのお菓子を買って町1にある家まで帰ってくるときの最大の満足度合計を求めよ。
</p>

<h2>Input</h2>
<p>入力は以下の形式ですべて整数で与えられる。</p>
<p>
$N$ $X$ $Y$<br>
駄菓子屋1の情報<br>
駄菓子屋2の情報<br>
... <br>
駄菓子屋$N$の情報<br>
$d_{11}$ $d_{12}$ ... $d_{1N}$<br>
$d_{21}$ $d_{22}$ ... $d_{2N}$<br>
...<br>
$d_{N1}$ $d_{N2}$ ... $d_{NN}$<br>
</p>
<p>
1行目に町の数$N$と所持金$X$,お菓子を買うために使うことができる上限金額$Y$が空白区切りで与えられる。<br>
2行目からは$N$個の各駄菓子屋の情報を与えられる。<br>
続く$N$行$N$列に町$i$と町$j$を直接行き来するために必要な金額$d_{ij}$が空白区切りで与えられる。<br>
</p>

<p>各駄菓子屋は以下の形式をしている。</p>
<p>
$K$<br>
$a_1$ $b_1$ $c_1$<br>
$a_2$ $b_2$ $c_2$<br>
...<br>
$a_K$ $b_K$ $c_K$<br>
</p>
<p>
1行目に駄菓子屋の売っているお菓子の種類数$K$が与えられる。<br>
続く$K$行にお菓子の1つの値段$a_i$,1つあたりの満足度$b_i$、在庫数$c_i$が空白区切りで与えられる。 
</p>


<h2>Constraints</h2>
<p>入力は以下の条件を満たす。</p>
<ul>
  <li>$1 \leq N \leq 14$</li>
  <li>$1 \leq X \leq 10000$</li>
  <li>$1 \leq Y \leq min(1000,X)$</li>
  <li>$1 \leq K \leq 300$</li>
  <li>$1 \leq a_i \leq 1000$</li>
  <li>$1 \leq b_i \leq 1000$</li>
  <li>$1 \leq c_i \leq 1000$</li>
  <li>$0 \leq d_{ij} \leq 10000$</li>
  <li>$d_{ii} = 0$</li>
</ul>

<h2>Output</h2>
<p>
  がっちょくんがお母さんからもらったお小遣い以内でお菓子を買って町1にある家まで帰ってくるときの最大の満足度合計。
</p>

<h2>Sample Input 1</h2>
<pre>
1 10 10
3
1 10 1
2 20 2
3 30 3
0
</pre>

<h2>Sample Output 1</h2>
<pre>
100
</pre>

<h2>Sample Input 2</h2>
<pre>
2 10 10
3
1 10 1
2 20 2
3 30 3
1
5 200 1
0 2
3 0
</pre>

<h2>Sample Output 2</h2>
<pre>
200
</pre>

<h2>Sample Input 3</h2>
<pre>
3 10 10
1
1 1 1
1
3 3 3
1
5 5 5
0 1 0
1 0 0
0 1 0
</pre>

<h2>Sample Output 3</h2>
<pre>
10
</pre>

<h2>Sample Input 4</h2>
<pre>
4 59 40
1
7 6 3
1
10 3 9
2
9 8 5
7 6 10
4
8 2 9
1 7 1
7 7 9
1 2 3
0 28 7 26
14 0 10 24
9 6 0 21
9 24 14 0
</pre>

<h2>Sample Output 3</h2>
<pre>
34
</pre>
